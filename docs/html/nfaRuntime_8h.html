<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GrrEngine: nfaRuntime.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GrrEngine
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">Unix regex library.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">nfaRuntime.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Regex-matching functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &quot;<a class="el" href="nfaDef_8h_source.html">nfaDef.h</a>&quot;</code><br />
</div>
<p><a href="nfaRuntime_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a17c42a4f6b487298bd860525722bed87"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nfaRuntime_8h.html#a17c42a4f6b487298bd860525722bed87">grrMatch</a> (const <a class="el" href="nfaDef_8h.html#a8dc2a3a897ffdcfa126a67035ce05079">grrNfa</a> nfa, const char *string, size_t len)</td></tr>
<tr class="memdesc:a17c42a4f6b487298bd860525722bed87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if the entire string matches the regex.  <a href="nfaRuntime_8h.html#a17c42a4f6b487298bd860525722bed87">More...</a><br /></td></tr>
<tr class="separator:a17c42a4f6b487298bd860525722bed87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14200df8aa9eeee41c91634b5b90bd0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nfaRuntime_8h.html#a14200df8aa9eeee41c91634b5b90bd0e">grrSearch</a> (<a class="el" href="nfaDef_8h.html#a8dc2a3a897ffdcfa126a67035ce05079">grrNfa</a> nfa, const char *string, size_t len, size_t *start, size_t *end, size_t *cursor, bool tolerant)</td></tr>
<tr class="memdesc:a14200df8aa9eeee41c91634b5b90bd0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if a string contains a substring which matches the regex.  <a href="nfaRuntime_8h.html#a14200df8aa9eeee41c91634b5b90bd0e">More...</a><br /></td></tr>
<tr class="separator:a14200df8aa9eeee41c91634b5b90bd0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a046e6c73954ed8432cea330ea4c0b5cc"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nfaRuntime_8h.html#a046e6c73954ed8432cea330ea4c0b5cc">grrFirstMatch</a> (<a class="el" href="nfaDef_8h.html#a8dc2a3a897ffdcfa126a67035ce05079">grrNfa</a> *nfa_list, size_t num, FILE *file, char *destination, size_t capacity, size_t *size)</td></tr>
<tr class="memdesc:a046e6c73954ed8432cea330ea4c0b5cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the index of regex which matches most of the input from the file stream.  <a href="nfaRuntime_8h.html#a046e6c73954ed8432cea330ea4c0b5cc">More...</a><br /></td></tr>
<tr class="separator:a046e6c73954ed8432cea330ea4c0b5cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Regex-matching functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a046e6c73954ed8432cea330ea4c0b5cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a046e6c73954ed8432cea330ea4c0b5cc">&#9670;&nbsp;</a></span>grrFirstMatch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t grrFirstMatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nfaDef_8h.html#a8dc2a3a897ffdcfa126a67035ce05079">grrNfa</a> *&#160;</td>
          <td class="paramname"><em>nfa_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the index of regex which matches most of the input from the file stream. </p>
<p>Characters are read from the file stream and stored into destination until EOF is reached, capacity is reached, or a non-printable character or newline is encountered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nfa_list</td><td>The array of Grr regex objects. </td></tr>
    <tr><td class="paramname">num</td><td>The length of the array. </td></tr>
    <tr><td class="paramname">file</td><td>The file stream. </td></tr>
    <tr><td class="paramname">destination</td><td>Where the read characters will be stored. If a non-printable character or a newline is encountered, it will not be store but will be put back in the stream to be read later. </td></tr>
    <tr><td class="paramname">capacity</td><td>The size of the destination buffer. </td></tr>
    <tr><td class="paramname">size</td><td>*size will hold will number of characters stored in destination. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The index of the regex with the longest match of the input or -1 if either no such match was found or either nfa_list, file, destination, or size is NULL. </dd></dl>

</div>
</div>
<a id="a17c42a4f6b487298bd860525722bed87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c42a4f6b487298bd860525722bed87">&#9670;&nbsp;</a></span>grrMatch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grrMatch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="nfaDef_8h.html#a8dc2a3a897ffdcfa126a67035ce05079">grrNfa</a>&#160;</td>
          <td class="paramname"><em>nfa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if the entire string matches the regex. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nfa</td><td>The Grr regex object. </td></tr>
    <tr><td class="paramname">string</td><td>The string (does not have to be null-terminated). </td></tr>
    <tr><td class="paramname">len</td><td>The length of the string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>GRR_RET_OK if the string matched the regex. GRR_RET_BAD_ARGS is either nfa or string is NULL. GRR_RET_OUT_MEMORY if a memory allocation failed. GRR_RET_BAD_DATA if the string contained a non-printable character. </dd></dl>

</div>
</div>
<a id="a14200df8aa9eeee41c91634b5b90bd0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14200df8aa9eeee41c91634b5b90bd0e">&#9670;&nbsp;</a></span>grrSearch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grrSearch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nfaDef_8h.html#a8dc2a3a897ffdcfa126a67035ce05079">grrNfa</a>&#160;</td>
          <td class="paramname"><em>nfa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>cursor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>tolerant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if a string contains a substring which matches the regex. </p>
<p>The function will stop processing characters when either it exhausts the specified length, a newline is encountered, or a non-printable character is encountered with tolerateNonprintables set to false. If tolerateNonprintables is true, then the function will skip over such characters and treat them as beginning and end of lines. For example, if the regex is "^a+" and the string is "aa\x00aaad", then both sequences of "a"'s will be considered matches. However, they will be considered separate matches and so *end-*start will be 3.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nfa</td><td>The Grr regex object. </td></tr>
    <tr><td class="paramname">string</td><td>The string (does not have to be null-terminated). </td></tr>
    <tr><td class="paramname">len</td><td>The length of the string. </td></tr>
    <tr><td class="paramname">start</td><td>A pointer which will, if not NULL, point to the index of the beginning of the longest match if one was found. </td></tr>
    <tr><td class="paramname">end</td><td>A pointer which will, if not NULL, point to the index of the character after the end of the longest match if one was found. </td></tr>
    <tr><td class="paramname">cursor</td><td>A pointer which will, if not NULL, point to the index of the character where the function stopped searching. </td></tr>
    <tr><td class="paramname">tolerant</td><td>Indicates whether or not the function should exit upon encountering a non-printable character. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>GRR_RET_OK if a substring match was found. GRR_RET_BAD_ARGS if either nfa or string is NULL. GRR_RET_NOT_FOUND if no substring match was found. GRR_RET_BAD_DATA if the string contained a non-printable character and tolerant was set to false. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
